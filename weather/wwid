    rows = []  # List to store matched row pairs

    # Iterate over the matrix
    for col1 in match_matrix.index:  # Rows (df1 ID columns)
        for col2 in match_matrix.columns:  # Columns (df2 ID columns)
            matched_ids = match_matrix.at[col1, col2]  # Get matched ID list
            
            if matched_ids:  # If there are matched values
                for match_id in matched_ids:
                    # Retrieve matching rows from df1 and df2
                    rows_df1 = df1[df1[col1].astype(str) == match_id]
                    rows_df2 = df2[df2[col2].astype(str) == match_id]

                    # Store the matched pairs in df3
                    for _, row_df1 in rows_df1.iterrows():
                        for _, row_df2 in rows_df2.iterrows():
                            rows.append({
                                'df1_id_col': col1,
                                'df2_id_col': col2,
                                'matched_id': match_id,
                                'df1_row': row_df1.to_dict(),  # Store full row from df1
                                'df2_row': row_df2.to_dict()   # Store full row from df2
                            })

    # Convert to DataFrame
    df3 = pd.DataFrame(rows)    
