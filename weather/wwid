# Reshape residuals into a panel structure
residual_matrix = df.pivot(index='indivi# Compute pairwise correlations between individuals
correlation_matrix = residual_matrix.corr()

# Compute the Pesaran CD test statistic
N = correlation_matrix.shape[0]  # Number of individuals
T = correlation_matrix.shape[1]  # Number of time periods
cd_statistic = np.sqrt(2 * T / (N * (N - 1))) * np.sum(np.triu(correlation_matrix, k=1))

# Compute the p-value (under the null of no cross-sectional correlation)
from scipy.stats import norm
p_value = 2 * (1 - norm.cdf(np.abs(cd_statistic)))

print(f"Pesaran CD Test Statistic: {cd_statistic}, P-value: {p_value}")dual_id', columns='time_period', values='residuals')


