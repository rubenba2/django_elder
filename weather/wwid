import pandas as pd

# Load the Excel file
file_path = 'your_file.xlsx'  # Update with your actual file path
df = pd.read_excel(file_path, sheet_name='Sheet1')  # Change 'Sheet1' if needed

# Specify the column to split by (assuming 'colasdf' is in column 'AP' - 41st column)
col_to_split = 'AP'

# Create a new Excel writer object
with pd.ExcelWriter('output_split_data.xlsx', engine='openpyxl') as writer:
    # Loop through each unique value in the 'colasdf' column
    for value in df[col_to_split].unique():
        # Filter the DataFrame for the current value
        filtered_df = df[df[col_to_split] == value]
        
        # Sanitize sheet name: remove invalid characters and limit length to 31 characters
        sheet_name = str(value)
        sheet_name = sheet_name.translate(str.maketrans('', '', r'\/:*?"<>|'))  # Remove invalid chars
        sheet_name = sheet_name[:31]  # Truncate to 31 characters if too long
        
        # Write the filtered data to the new sheet
        filtered_df.to_excel(writer, sheet_name=sheet_name, index=False)

print("Data has been split into separate sheets!")
