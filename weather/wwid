import pandas as pd
import numpy as np

def calculate_migration_shares(df, period_months=12):
    # Calculate migration matrix (cross-tabulation)
    migration_matrix = calculate_migration_matrix(df, period_months)
    
    # Total number of observations (sum of all entries in the matrix)
    total_observations = migration_matrix.sum().sum()
    
    # Diagonal elements (no migration)
    no_migration = np.trace(migration_matrix.values)
    
    # Percentages of migrations
    migration_1_rating = migration_matrix.values[0:3, 0:3].sum()
    migration_2_ratings = migration_matrix.values[0:2, 0:2].sum()
    migration_3_or_more = migration_matrix.values.sum() - migration_1_rating - migration_2_ratings
    
    # Calculate percentages
    percent_no_migration = no_migration / total_observations * 100
    percent_1_rating = migration_1_rating / total_observations * 100
    percent_2_ratings = migration_2_ratings / total_observations * 100
    percent_3_or_more = migration_3_or_more / total_observations * 100
    
    # Create DataFrame for results
    results = pd.DataFrame({
        'Metric': ['No Migration', '1 Rating', '2 Ratings', '3 Ratings or more'],
        'Share (%)': [percent_no_migration, percent_1_rating, percent_2_ratings, percent_3_or_more]
    })

    return results

# Example usage:
migration_shares_12months = calculate_migration_shares(cohort_data, period_months=12)
print(migration_shares_12months)
