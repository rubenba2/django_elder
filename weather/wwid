# Columns to exclude from processing
exclude_cols = ['E']

# Step 1: Drop columns with more than 30% missing values (excluding specified columns)
threshold = 0.3 * len(df)
df_filtered = df.dropna(thresh=threshold, axis=1)

# Step 2 & 3: Fill missing values based on data type
for col in df_filtered.columns:
    if col in exclude_cols:
        continue  # Skip excluded columns
    
    if df_filtered[col].dtype == 'O':  # Categorical or String
        mode_value = df_filtered[col].mode().iloc[0]  # Most frequent value
        df_filtered[col].fillna(mode_value, inplace=True)
    else:  # Numeric
        median_value = df_filtered[col].median()  # Median of column
        df_filtered[col].fillna(median_value, inplace=True)

# Display cleaned DataFrame
print(df_filtered)
