Sub ExportTableCaptionsToCSV()
    Dim tbl As Table
    Dim para As Paragraph
    Dim fullText As String
    Dim tableCount As Integer
    Dim outputPath As String
    Dim fso As Object
    Dim txtStream As Object
    
    ' Set output file path (same folder as document)
    outputPath = ThisDocument.Path & "\table_captions.csv"
    
    ' Create FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set txtStream = fso.CreateTextFile(outputPath, True)
    
    ' Write CSV header
    txtStream.WriteLine "Full_Caption"
    
    tableCount = 1
    
    ' Loop through all tables
    For Each tbl In ActiveDocument.Tables
        fullText = ""
        
        ' Try to find caption (usually the paragraph before the table)
        On Error Resume Next
        fullText = tbl.Range.Paragraphs(1).Previous.Range.Text
        On Error GoTo 0
        
        If fullText <> "" Then
            ' Clean up line breaks only
            fullText = Replace(fullText, vbCr, "")
            fullText = Replace(fullText, vbLf, "")
            fullText = Trim(fullText)
            
            ' Escape quotes for CSV
            fullText = Replace(fullText, """", """""")
            
            ' Write full text to CSV
            txtStream.WriteLine """" & fullText & """"
        Else
            ' No caption found
            txtStream.WriteLine """"""
        End If
        
        tableCount = tableCount + 1
    Next tbl
    
    txtStream.Close
    
    MsgBox "Exported " & (tableCount - 1) & " tables to:" & vbCrLf & outputPath, vbInformation
    
End Sub
