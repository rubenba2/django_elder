def calculate_categorical_psi(expected, actual):
    # 1. Get the percentage distribution for both strings
    expected_perc = expected.value_counts(normalize=True)
    actual_perc = actual.value_counts(normalize=True)

    # 2. Align them into one table (handles missing categories in either string)
    df = pd.DataFrame({'expected': expected_perc, 'actual': actual_perc}).fillna(0.0001)

    # 3. Apply the PSI formula per category
    df['psi_elements'] = (df['actual'] - df['expected']) * np.log(df['actual'] / df['expected'])
    
    # 4. Sum them up
    return df['psi_elements'].sum()
