Sub ExportTableCaptionsToCSV()
    Dim tbl As Table
    Dim para As Paragraph
    Dim caption As String
    Dim tableNum As Integer
    Dim outputPath As String
    Dim fso As Object
    Dim txtStream As Object
    
    ' Set output file path (same folder as document)
    outputPath = ThisDocument.Path & "\table_captions.csv"
    
    ' Create FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set txtStream = fso.CreateTextFile(outputPath, True)
    
    ' Write CSV header
    txtStream.WriteLine "Table_Number,Caption"
    
    tableNum = 1
    
    ' Loop through all tables
    For Each tbl In ActiveDocument.Tables
        caption = ""
        
        ' Try to find caption (usually the paragraph before the table)
        On Error Resume Next
        caption = tbl.Range.Paragraphs(1).Previous.Range.Text
        On Error GoTo 0
        
        If caption <> "" Then
            caption = Replace(caption, vbCr, "")
            caption = Replace(caption, vbLf, "")
            caption = Replace(caption, """", """""") ' Escape quotes for CSV
            caption = Trim(caption)
        End If
        
        ' Write to CSV with quotes around caption
        txtStream.WriteLine tableNum & ",""" & caption & """"
        
        tableNum = tableNum + 1
    Next tbl
    
    txtStream.Close
    
    MsgBox "Exported " & (tableNum - 1) & " tables to:" & vbCrLf & outputPath, vbInformation
    
End Sub
